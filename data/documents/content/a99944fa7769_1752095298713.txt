Trump had lashed out against holdouts, threatening to campaign against one Republican, Sen. Thom Tillis of North Carolina, who had announced he could not support the bill because of Medicaid cuts that he worried would leave many without health care in his state. A new analysis from the nonpartisan Congressional Budget Office said the Senate version of the bill would increase by 11.8 million the number of people without health insurance in 2034.

Republicans are using their majorities in Congress to push aside Democratic opposition, but they have run into a series of political and policy setbacks. Not all GOP lawmakers are on board with proposals to reduce spending on Medicaid, food stamps and other programs as a way to help cover the cost of extending some $3.8 trillion in Trump tax breaks.

“Tonight we saw a GREAT VICTORY in the Senate,” Trump said in a social media post afterward.

By a 51-49 tally and with Vice President JD Vance at the Capitol to break a potential tie, the Senate cleared a key procedural step Saturday as midnight approached. Voting had come to a standstill, dragging for more than three hours, with holdout senators huddling for negotiations and taking private meetings off the Senate floor. In the end, two Republicans opposed the motion to move ahead on Trump’s signature domestic policy plan, joining all 47 Democrats.

WASHINGTON (AP) — Capping a tumultuous night, the Republican-controlled Senate advanced President Donald Trump’s package of tax breaks, spending cuts and increased deportation money, with more weekend work ahead as Congress races to meet his Fourth of July deadline for passage.

Renewed pressure to oppose the 940-page bill came from Elon Musk, who criticized it as “utterly insane and destructive.”

Ahead for senators now will be an all-night debate and amendments. If they are able to pass it, the bill would return to the House for a final round of votes before it could reach the White House. With the narrow Republican majorities in the House and Senate, leaders need almost every lawmaker on board.

READ MORE: What’s in the latest version of Trump’s ‘big bill’ Senate Republicans are trying to pass

Senate Democratic leader Chuck Schumer of New York said Republicans released the bill “in the dead of night” on Friday and were rushing through before the public fully knew what was in it. He forced a full reading of the text that began late Saturday and continued into Sunday morning.

Tax breaks and core GOP priorities

At its core, the legislation would make permanent many of the tax breaks from Trump’s first term that would otherwise expire by year’s end if Congress fails to act, resulting in a potential tax increase on Americans. The bill would add new breaks, including no taxes on tips, and commit $350 billion to national security, including for Trump’s mass deportation agenda.

READ MORE: 4 ways Trump’s big bill could change the U.S. immigration system

But the cutbacks to Medicaid, food stamps and green energy investments are also causing dissent within GOP ranks. Sen. Ron Wyden, D-Ore., said the environmental rollbacks would amount to a “death sentence” for America’s wind and solar industries.

The Republicans are relying on the reductions to offset the lost tax revenues but some lawmakers say the cuts go too far, particularly for people receiving health care through Medicaid. Meanwhile, conservatives, worried about the nation’s debt, are pushing for steeper cuts.

A dramatic roll call

As the roll call teetered, attention turned to Sen. Lisa Murkowski, R-Alaska, who was surrounded by GOP leaders in intense conversation. She voted “yes.”

A short time later, Majority Leader John Thune, R-S.D., drew holdouts Sen. Rick Scott of Florida, Mike Lee of Utah and Cynthia Lummis of Wyoming to his office. Vance joined in. The talks dragged on.

Then Vance led them all back in to vote.

Later, Scott said he had met with the president, adding, “We all want to get to yes.”

Lee said the group “had an internal discussion about the strategy to achieve more savings and more deficit reduction, and I feel good about the direction where this is going, and more to come.”

Republicans revise after setbacks by Senate’s arbiter

The release of the bill’s draft had been delayed as the Senate parliamentarian reviewed the measure to ensure it complied with the chamber’s strict “Byrd Rule,” named for the late Sen. Robert C. Byrd, D-W.Va. It largely bars policy matters from inclusion in budget bills unless a provision can get 60 votes to overcome objections.

READ MORE: This key provision of Trump’s big bill violates Senate rules. Here’s what to know about provider taxes

Republicans suffered a series of setbacks after several proposals, including shifting food stamp costs from the federal government to the states or gutting the funding structure of the Consumer Financial Protection Bureau, were deemed out of compliance with the rules.

But over the past days, Republicans have quickly revised those proposals and reinstated them.

The final text includes a proposal for cuts to the Medicaid provider tax that had run into parliamentary hurdles and objections from several senators worried about the fate of rural hospitals. The new version extends the start date for those cuts and establishes a $25 billion fund to aid rural hospitals and providers.

Top income-earners would see about a $12,000 tax cut under the House bill, while the package would cost the poorest Americans $1,600, the CBO said.

Tussle over SALT

The Senate included a compromise over the so-called SALT provision, a deduction for state and local taxes that has been a top priority of lawmakers from New York and other high-tax states, but the issue remains unsettled.

The current SALT cap is $10,000 a year, and a handful of Republicans wanted to boost it to $40,000 a year. The final draft includes a $40,000 cap, but limits it for five years. Many Republican senators say that is still too generous, but House Republicans are not fully satisfied either.

House Speaker Mike Johnson sent his colleagues home for the weekend with plans to be on call to return to Washington.

Associated Press writers Ali Swenson, Fatima Hussein, Michelle L. Price and Matthew Daly contributed to this report.